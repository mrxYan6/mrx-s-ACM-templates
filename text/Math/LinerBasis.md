# 线形基

本质为高斯消元。

## trick

### 对某个线形基能表示的数计数
每个线性基能表示的数可以出现$2^{n-r}$，其中n是数组的大小，r是线性基中的线性无关的向量的个数。

### 用线形基处理异或和的第k小的值
构造完线性基的之后，从小往大处理在线形基中的数，使得当前数的最大二进制位在整个线性基中只出现一次（类似于高斯消元）。

这样整个线性基的值都是递减的，那么直接使用二进制拆解k，用线性基中第i位表示$2^i$，然后全部异或起来，这样就是第k大。

### 寻找线性基中的最大的刚好小于等于x的数

和处理第k小的值的过程类似，先rebuid线形基。

然后从高位向低位贪心，如果当前位异或上x之后的值大于x，那么就不选这个数，否则就选这个数。

这样就能求出所需的值。

### 求某个集合是否对异或封闭

封闭的定义为:集合中任意两个数异或的值也在集合中。

定义一个异或空间为对异或封闭的集合。

如果某个异或空间有 $n$ 组基底，那么这个异或空间的大小为 $2^n$。

那么通过线形基求出一个集合的基底个数 $n$ 然后判断原集合的大小是否为 $2^n$ 即可。

(ps.高斯消元也可以求出来基底，但是复杂度更高，线形基的复杂度为:$(O(nm^2/64))$，高斯消元的复杂度为:$(O(n^2m/64))$)